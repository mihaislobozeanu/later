later=function(){"use strict";function t(t,e){for(var n=new Date(t,e+1,0).getDate(),a=new Date(t,e,1).getDay()-1,r={weekDays:{values:[],map:{}},weekendDays:{values:[],map:{}}},u=-1,i=-1,v=1;v<=n;v++){var l=(v+a)%7;0==l||6==l?(r.weekendDays.map[v]={value:u=r.weekendDays.values.push(v)-1,valid:!0},r.weekDays.map[v]={value:i+1,valid:!1}):(r.weekDays.map[v]={value:i=r.weekDays.values.push(v)-1,valid:!0},r.weekendDays.map[v]={value:u+1,valid:!1})}return r}var e={version:"1.2.0"};Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(null==this)throw new TypeError;var e=Object(this),n=e.length>>>0;if(0===n)return-1;var a=0;if(arguments.length>1&&(a=Number(arguments[1]),a!=a?a=0:0!=a&&a!=1/0&&a!=-1/0&&(a=(a>0||-1)*Math.floor(Math.abs(a)))),a>=n)return-1;for(var r=a>=0?a:Math.max(n-Math.abs(a),0);r<n;r++)if(r in e&&e[r]===t)return r;return-1}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),e.array={},e.array.sort=function(t,e){t.sort(function(t,e){return+t-+e}),e&&0===t[0]&&t.push(t.shift())},e.array.next=function(t,e,n){for(var a,r=0!==n[0],u=0,i=e.length-1;i>-1;--i){if((a=e[i])===t)return a;if(!(a>t||0===a&&r&&n[1]>t))break;u=i}return e[u]},e.array.nextInvalid=function(t,e,n){for(var a=n[0],r=n[1],u=e.length,i=0===e[u-1]&&0!==a?r:0,v=t,l=e.indexOf(t),o=v;v===(e[l]||i);)if(v++,v>r&&(v=a),l++,l===u&&(l=0),v===o)return;return v},e.array.prev=function(t,e,n){for(var a,r=e.length,u=0!==n[0],i=r-1,v=0;v<r;v++){if((a=e[v])===t)return a;if(!(a<t||0===a&&u&&n[1]<t))break;i=v}return e[i]},e.array.prevInvalid=function(t,e,n){for(var a=n[0],r=n[1],u=e.length,i=0===e[u-1]&&0!==a?r:0,v=t,l=e.indexOf(t),o=v;v===(e[l]||i);)if(v--,v<a&&(v=r),l--,-1===l&&(l=u-1),v===o)return;return v},e.day=e.D={name:"day",range:86400,val:function(t){return t.D||(t.D=e.date.getDate.call(t))},isValid:function(t,n){return e.D.val(t)===(n||e.D.extent(t)[1])},extent:function(t){if(t.DExtent)return t.DExtent;var n=e.M.val(t),a=e.DAYS_IN_MONTH[n-1];return 2===n&&366===e.dy.extent(t)[1]&&(a+=1),t.DExtent=[1,a]},start:function(t){return t.DStart||(t.DStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)))},end:function(t){return t.DEnd||(t.DEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)))},next:function(t,n){n=n>e.D.extent(t)[1]?1:n;var a=e.date.nextRollover(t,n,e.D,e.M),r=e.D.extent(a)[1];return n=n>r?1:n||r,e.date.next(e.Y.val(a),e.M.val(a),n)},prev:function(t,n){var a=e.date.prevRollover(t,n,e.D,e.M),r=e.D.extent(a)[1];return e.date.prev(e.Y.val(a),e.M.val(a),n>r?r:n||r)}},e.dayEx=e.DX={rangeStart:new Date("2015-01-01"),rangeEnd:new Date("2050-01-01"),name:"dayEx",range:86400,val:function(t){return t.DX||(t.DX=e.date.diffInDays(e.DX.rangeStart,t))},isValid:function(t,n){return e.DX.val(t)===(n||e.DX.extent(t)[1])},extent:function(t){if(t.DXExtent)return t.DXExtent;var n=Math.floor(e.DX.rangeEnd.getTime()/e.DAY)-Math.floor(e.DX.rangeStart.getTime()/e.DAY);return t.DXExtent=[1,n]},start:function(t){return t.DXStart||(t.DXStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)))},end:function(t){return t.DXEnd||(t.DXEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)))},next:function(t,n){return new Date(e.DX.rangeStart.getTime()+n*e.DAY)},prev:function(t,n){return new Date(e.DX.rangeStart.getTime()+n*e.DAY)}},e.weekday=e.WD={name:"weekday",range:86400,val:function(t){if(t.WD)return t.WD;var n=e.WD.weekdaysInMonth(t),a=e.date.getDate.call(t);return t.WD=n.map[a].value+1},weekdaysInMonth:function(t){return t.weekdaysInMonth||(t.weekdaysInMonth=e.date.weekdaysInMonth(t))},isValid:function(t,n){if(e.WD.val(t)===(n||e.WD.extent(t)[1])){var a=e.WD.weekdaysInMonth(t),r=e.date.getDate.call(t);return a.map[r].valid}return!1},extent:function(t){if(t.WDExtent)return t.WDExtent;var n=e.WD.weekdaysInMonth(t);return t.WDExtent=[1,n.values.length]},start:function(t){return t.WDStart||(t.WDStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)))},end:function(t){return t.WDEnd||(t.WDEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)))},next:function(t,n){var a=e.WD.extent(t)[1];n=n>a?1:n;var r=e.WD.weekdaysInMonth(t),u=r.values[(n||a)-1],i=e.date.nextRollover(t,u,e.D,e.M);return a=e.WD.extent(i)[1],n=n>a?1:n||a,r=e.WD.weekdaysInMonth(i),u=r.values[n-1],e.date.next(e.Y.val(i),e.M.val(i),u)},prev:function(t,n){var a=e.WD.weekdaysInMonth(t),r=a.values[(n||i)-1],u=e.date.prevRollover(t,r,e.D,e.M),i=e.WD.extent(u)[1];return n=n>i?i:n||i,a=e.WD.weekdaysInMonth(u),r=a.values[n-1],e.date.prev(e.Y.val(u),e.M.val(u),r)}},e.weekendDay=e.WED={name:"weekendDay",range:86400,val:function(t){if(t.WED)return t.WED;var n=e.WED.weekendDaysInMonth(t),a=e.date.getDate.call(t);return t.WED=n.map[a].value+1},weekendDaysInMonth:function(t){return t.weekendDaysInMonth||(t.weekendDaysInMonth=e.date.weekendDaysInMonth(t))},isValid:function(t,n){if(e.WED.val(t)===(n||e.WED.extent(t)[1])){var a=e.WED.weekendDaysInMonth(t),r=e.date.getDate.call(t);return a.map[r].valid}return!1},extent:function(t){if(t.WDExtent)return t.WDExtent;var n=e.WED.weekendDaysInMonth(t);return t.WDExtent=[1,n.values.length]},start:function(t){return t.WDStart||(t.WDStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)))},end:function(t){return t.WDEnd||(t.WDEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)))},next:function(t,n){var a=e.WED.extent(t)[1];n=n>a?1:n;var r=e.WED.weekendDaysInMonth(t),u=r.values[(n||a)-1],i=e.date.nextRollover(t,u,e.D,e.M);return a=e.WED.extent(i)[1],n=n>a?1:n||a,r=e.WED.weekendDaysInMonth(i),u=r.values[n-1],e.date.next(e.Y.val(i),e.M.val(i),u)},prev:function(t,n){var a=e.WD.weekendDaysInMonth(t),r=a.values[(n||i)-1],u=e.date.prevRollover(t,r,e.D,e.M),i=e.WD.extent(u)[1];return n=n>i?i:n||i,a=e.WD.weekendDaysInMonth(u),r=a.values[n-1],e.date.prev(e.Y.val(u),e.M.val(u),r)}},e.dayOfWeekCount=e.dc={name:"day of week count",range:604800,val:function(t){return t.dc||(t.dc=Math.floor((e.D.val(t)-1)/7)+1)},isValid:function(t,n){return e.dc.val(t)===n||0===n&&e.D.val(t)>e.D.extent(t)[1]-7},extent:function(t){return t.dcExtent||(t.dcExtent=[1,Math.ceil(e.D.extent(t)[1]/7)])},start:function(t){return t.dcStart||(t.dcStart=e.date.next(e.Y.val(t),e.M.val(t),Math.max(1,7*(e.dc.val(t)-1)+1||1)))},end:function(t){return t.dcEnd||(t.dcEnd=e.date.prev(e.Y.val(t),e.M.val(t),Math.min(7*e.dc.val(t),e.D.extent(t)[1])))},next:function(t,n){n=n>e.dc.extent(t)[1]?1:n;var a=e.date.nextRollover(t,n,e.dc,e.M);n=n>e.dc.extent(a)[1]?1:n;var r=e.date.next(e.Y.val(a),e.M.val(a),0===n?e.D.extent(a)[1]-6:1+7*(n-1));return r.getTime()<=t.getTime()?(a=e.M.next(t,e.M.val(t)+1),e.date.next(e.Y.val(a),e.M.val(a),0===n?e.D.extent(a)[1]-6:1+7*(n-1))):r},prev:function(t,n){var a=e.date.prevRollover(t,n,e.dc,e.M),r=e.dc.extent(a)[1];return n=n>r?r:n||r,e.dc.end(e.date.prev(e.Y.val(a),e.M.val(a),1+7*(n-1)))}},e.dayOfWeek=e.dw=e.d={name:"day of week",range:86400,val:function(t){return t.dw||(t.dw=e.date.getDay.call(t)+1)},isValid:function(t,n){return e.dw.val(t)===(n||7)},extent:function(){return[1,7]},start:function(t){return e.D.start(t)},end:function(t){return e.D.end(t)},next:function(t,n){return n=n>7?1:n||7,e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n-e.dw.val(t))+(n<=e.dw.val(t)?7:0))},prev:function(t,n){return n=n>7?7:n||7,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)+(n-e.dw.val(t))+(n>=e.dw.val(t)?-7:0))}},e.dayOfYear=e.dy={name:"day of year",range:86400,val:function(t){return t.dy||(t.dy=Math.ceil(1+(e.D.start(t).getTime()-e.Y.start(t).getTime())/e.DAY))},isValid:function(t,n){return e.dy.val(t)===(n||e.dy.extent(t)[1])},extent:function(t){var n=e.Y.val(t);return t.dyExtent||(t.dyExtent=[1,n%4?365:366])},start:function(t){return e.D.start(t)},end:function(t){return e.D.end(t)},next:function(t,n){n=n>e.dy.extent(t)[1]?1:n;var a=e.date.nextRollover(t,n,e.dy,e.Y),r=e.dy.extent(a)[1];return n=n>r?1:n||r,e.date.next(e.Y.val(a),e.M.val(a),n)},prev:function(t,n){var a=e.date.prevRollover(t,n,e.dy,e.Y),r=e.dy.extent(a)[1];return n=n>r?r:n||r,e.date.prev(e.Y.val(a),e.M.val(a),n)}},e.hour=e.h={name:"hour",range:3600,val:function(t){return t.h||(t.h=e.date.getHour.call(t))},isValid:function(t,n){return e.h.val(t)===n},extent:function(){return[0,23]},start:function(t){return t.hStart||(t.hStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t)))},end:function(t){return t.hEnd||(t.hEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t)))},next:function(t,n){n=n>23?0:n;var a=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n<=e.h.val(t)?1:0),n);return!e.date.isUTC&&a.getTime()<=t.getTime()&&(a=e.date.next(e.Y.val(a),e.M.val(a),e.D.val(a),n+1)),a},prev:function(t,n){return n=n>23?23:n,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)+(n>=e.h.val(t)?-1:0),n)}},e.minute=e.m={name:"minute",range:60,val:function(t){return t.m||(t.m=e.date.getMin.call(t))},isValid:function(t,n){return e.m.val(t)===n},extent:function(t){return[0,59]},start:function(t){return t.mStart||(t.mStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t),e.m.val(t)))},end:function(t){return t.mEnd||(t.mEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t),e.m.val(t)))},next:function(t,n){var a=e.m.val(t),r=e.s.val(t),u=n>59?60-a:n<=a?60-a+n:n-a,i=new Date(t.getTime()+u*e.MIN-r*e.SEC);return!e.date.isUTC&&i.getTime()<=t.getTime()&&(i=new Date(t.getTime()+(u+120)*e.MIN-r*e.SEC)),i},prev:function(t,n){return n=n>59?59:n,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t)+(n>=e.m.val(t)?-1:0),n)}},e.month=e.M={name:"month",range:2629740,val:function(t){return t.M||(t.M=e.date.getMonth.call(t)+1)},isValid:function(t,n){return e.M.val(t)===(n||12)},extent:function(){return[1,12]},start:function(t){return t.MStart||(t.MStart=e.date.next(e.Y.val(t),e.M.val(t)))},end:function(t){return t.MEnd||(t.MEnd=e.date.prev(e.Y.val(t),e.M.val(t)))},next:function(t,n){return n=n>12?1:n||12,e.date.next(e.Y.val(t)+(n>e.M.val(t)?0:1),n)},prev:function(t,n){return n=n>12?12:n||12,e.date.prev(e.Y.val(t)-(n>=e.M.val(t)?1:0),n)}},e.monthEx=e.MX={name:"monthEx",range:2629740,val:function(t){return t.MX||(t.MX=e.date.diffInMonths(e.MX.start(e.DX.rangeStart),e.MX.start(t)))},isValid:function(t,n){return e.MX.val(t)===(n||e.MX.extent(t)[1])},extent:function(t){if(t.MXExtent)return t.MXExtent;var n=e.date.diffInMonths(e.MX.start(e.DX.rangeStart),e.MX.start(e.DX.rangeEnd));return t.MXExtent=[1,n]},start:function(t){return t.MXStart||(t.MXStart=e.date.startOfMonth(t))},end:function(t){return t.MXEnd||(t.MXEnd=e.date.endOfMonth(t))},next:function(t,n){var a=new Date(e.MX.start(e.DX.rangeStart));return a.setMonth(a.getMonth()+n),a},prev:function(t,n){var a=new Date(e.MX.start(e.DX.rangeStart));return a.setMonth(a.getMonth()+n),a.setTime(a.getTime()-e.SEC),a}},e.second=e.s={name:"second",range:1,val:function(t){return t.s||(t.s=e.date.getSec.call(t))},isValid:function(t,n){return e.s.val(t)===n},extent:function(){return[0,59]},start:function(t){return t},end:function(t){return t},next:function(t,n){var a=e.s.val(t),r=n>59?60-a:n<=a?60-a+n:n-a,u=new Date(t.getTime()+r*e.SEC);return!e.date.isUTC&&u.getTime()<=t.getTime()&&(u=new Date(t.getTime()+(r+7200)*e.SEC)),u},prev:function(t,n,a){return n=n>59?59:n,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t),e.m.val(t)+(n>=e.s.val(t)?-1:0),n)}},e.time=e.t={name:"time",range:1,val:function(t){return t.t||(t.t=3600*e.h.val(t)+60*e.m.val(t)+e.s.val(t))},isValid:function(t,n){return e.t.val(t)===n},extent:function(){return[0,86399]},start:function(t){return t},end:function(t){return t},next:function(t,n){n=n>86399?0:n;var a=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n<=e.t.val(t)?1:0),0,0,n);return!e.date.isUTC&&a.getTime()<t.getTime()&&(a=e.date.next(e.Y.val(a),e.M.val(a),e.D.val(a),e.h.val(a),e.m.val(a),n+7200)),a},prev:function(t,n){return n=n>86399?86399:n,e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n>=e.t.val(t)?-1:0),0,0,n)}},e.weekOfMonth=e.wm={name:"week of month",range:604800,val:function(t){return t.wm||(t.wm=(e.D.val(t)+(e.dw.val(e.M.start(t))-1)+(7-e.dw.val(t)))/7)},isValid:function(t,n){return e.wm.val(t)===(n||e.wm.extent(t)[1])},extent:function(t){return t.wmExtent||(t.wmExtent=[1,(e.D.extent(t)[1]+(e.dw.val(e.M.start(t))-1)+(7-e.dw.val(e.M.end(t))))/7])},start:function(t){return t.wmStart||(t.wmStart=e.date.next(e.Y.val(t),e.M.val(t),Math.max(e.D.val(t)-e.dw.val(t)+1,1)))},end:function(t){return t.wmEnd||(t.wmEnd=e.date.prev(e.Y.val(t),e.M.val(t),Math.min(e.D.val(t)+(7-e.dw.val(t)),e.D.extent(t)[1])))},next:function(t,n){n=n>e.wm.extent(t)[1]?1:n;var a=e.date.nextRollover(t,n,e.wm,e.M),r=e.wm.extent(a)[1];return n=n>r?1:n||r,e.date.next(e.Y.val(a),e.M.val(a),Math.max(1,7*(n-1)-(e.dw.val(a)-2)))},prev:function(t,n){var a=e.date.prevRollover(t,n,e.wm,e.M),r=e.wm.extent(a)[1];return n=n>r?r:n||r,e.wm.end(e.date.next(e.Y.val(a),e.M.val(a),Math.max(1,7*(n-1)-(e.dw.val(a)-2))))}},e.weekOfYear=e.wy={name:"week of year (ISO)",range:604800,val:function(t){if(t.wy)return t.wy;var n=e.dw.next(e.wy.start(t),5),a=e.dw.next(e.Y.prev(n,e.Y.val(n)-1),5);return t.wy=1+Math.ceil((n.getTime()-a.getTime())/e.WEEK)},isValid:function(t,n){return e.wy.val(t)===(n||e.wy.extent(t)[1])},extent:function(t){if(t.wyExtent)return t.wyExtent;var n=e.dw.next(e.wy.start(t),5),a=e.dw.val(e.Y.start(n)),r=e.dw.val(e.Y.end(n));return t.wyExtent=[1,5===a||5===r?53:52]},start:function(t){return t.wyStart||(t.wyStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)-(e.dw.val(t)>1?e.dw.val(t)-2:6)))},end:function(t){return t.wyEnd||(t.wyEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)+(e.dw.val(t)>1?8-e.dw.val(t):0)))},next:function(t,n){n=n>e.wy.extent(t)[1]?1:n;var a=e.dw.next(e.wy.start(t),5),r=e.date.nextRollover(a,n,e.wy,e.Y);1!==e.wy.val(r)&&(r=e.dw.next(r,2));var u=e.wy.extent(r)[1],i=e.wy.start(r);return n=n>u?1:n||u,e.date.next(e.Y.val(i),e.M.val(i),e.D.val(i)+7*(n-1))},prev:function(t,n){var a=e.dw.next(e.wy.start(t),5),r=e.date.prevRollover(a,n,e.wy,e.Y);1!==e.wy.val(r)&&(r=e.dw.next(r,2));var u=e.wy.extent(r)[1],i=e.wy.end(r);return n=n>u?u:n||u,e.wy.end(e.date.next(e.Y.val(i),e.M.val(i),e.D.val(i)+7*(n-1)))}},e.weekEx=e.WX={name:"weekEx",range:604800,val:function(t){return t.WX?t.WX:t.WX=Math.ceil(e.date.diffInDays(e.WX.start(e.DX.rangeStart),e.WX.start(t))/7)},isValid:function(t,n){return e.WX.val(t)===(n||e.WX.extent(t)[1])},extent:function(t){if(t.WXExtent)return t.WXExtent;var n=Math.floor(e.date.diffInDays(e.WX.start(e.DX.rangeStart),e.WX.start(e.DX.rangeEnd))/7);return t.WXExtent=[1,n]},start:function(t){return t.WXStart||(t.WXStart=e.date.startOfWeek(t))},end:function(t){return t.WXEnd||(t.WXEnd=e.date.endOfWeek(t))},next:function(t,n){return new Date(e.WX.start(e.DX.rangeStart).getTime()+n*e.WEEK)},prev:function(t,n){var a=new Date(e.WX.start(e.DX.rangeStart).getTime()+n*e.WEEK);return a.setTime(a.getTime()-e.SEC),a}},e.year=e.Y={name:"year",range:31556900,val:function(t){return t.Y||(t.Y=e.date.getYear.call(t))},isValid:function(t,n){return e.Y.val(t)===n},extent:function(){return[1970,2099]},start:function(t){return t.YStart||(t.YStart=e.date.next(e.Y.val(t)))},end:function(t){return t.YEnd||(t.YEnd=e.date.prev(e.Y.val(t)))},next:function(t,n){return n>e.Y.val(t)&&n<=e.Y.extent()[1]?e.date.next(n):e.NEVER},prev:function(t,n){return n<e.Y.val(t)&&n>=e.Y.extent()[0]?e.date.prev(n):e.NEVER}},e.fullDate=e.fd={name:"full date",range:1,val:function(t){return t.fd||(t.fd=t.getTime())},isValid:function(t,n){return e.fd.val(t)===n},extent:function(){return[0,3250368e7]},start:function(t){return t},end:function(t){return t},next:function(t,n){return e.fd.val(t)<n?new Date(n):e.NEVER},prev:function(t,n){return e.fd.val(t)>n?new Date(n):e.NEVER}},e.modifier={},e.modifier.after=e.modifier.a=function(t,e){var n=e[0];return{name:"after "+t.name,range:(t.extent(new Date)[1]-n)*t.range,val:t.val,isValid:function(t,e){return this.val(t)>=n},extent:t.extent,start:t.start,end:t.end,next:function(e,a){return a!=n&&(a=t.extent(e)[0]),t.next(e,a)},prev:function(e,a){return a=a===n?t.extent(e)[1]:n-1,t.prev(e,a)}}},e.modifier.before=e.modifier.b=function(t,e){var n=e[e.length-1];return{name:"before "+t.name,range:t.range*(n-1),val:t.val,isValid:function(t,e){return this.val(t)<n},extent:t.extent,start:t.start,end:t.end,next:function(e,a){return a=a===n?t.extent(e)[0]:n,t.next(e,a)},prev:function(e,a){return a=a===n?n-1:t.extent(e)[1],t.prev(e,a)}}},e.compile=function(t){function n(t){return"next"===t?function(t,e){return t.getTime()>e.getTime()}:function(t,e){return e.getTime()>t.getTime()}}var a,r=[],u=0;for(var i in t){var v=i.split("_"),l=v[0],o=v[1],d=t[i],f=o?e.modifier[o](e[l],d):e[l];r.push({constraint:f,vals:d}),u++}return r.sort(function(t,e){var n=t.constraint.range,a=e.constraint.range;return a<n?-1:a>n?1:0}),a=r[u-1].constraint,{start:function(t,n){for(var i,v=n,l=e.array[t],o=1e3;o--&&!i&&v;){i=!0;for(var d=0;d<u;d++){var f=r[d].constraint,c=f.val(v),D=f.extent(v),s=l(c,r[d].vals,D);if(!f.isValid(v,s)){v=f[t](v,s),i=!1;break}}}return v!==e.NEVER&&(v="next"===t?a.start(v):a.end(v)),v},end:function(t,a){for(var i,v=e.array[t+"Invalid"],l=n(t),o=u-1;o>=0;o--){var d,f=r[o].constraint,c=f.val(a),D=f.extent(a),s=v(c,r[o].vals,D);void 0!==s&&(!(d=f[t](a,s))||i&&!l(i,d)||(i=d))}return i},tick:function(t,n){return new Date("next"===t?a.end(n).getTime()+e.SEC:a.start(n).getTime()-e.SEC)},tickStart:function(t){return a.start(t)}}},e.schedule=function(t){function n(t,n,g,w,h){var E,y,p,Y=D(t),T=n,W=1e3,S=[],X=[],k=[],I="next"===t,V=I?0:1,R=I?1:0;if(!(g=g?new Date(g):new Date)||!g.getTime())throw new Error("Invalid start date.");for(r(t,x,S,g),i(t,M,X,g);W--&&T&&(E=s(S,Y))&&(!w||!Y(E,w));)if(m&&(v(t,M,X,E),y=d(t,X,E)))u(t,x,S,y);else{if(h){var C=f(X,Y);y=c(t,x,S,E,C);var O=I?[new Date(Math.max(g,E)),y?new Date(w?Math.min(y,w):y):void 0]:[y?new Date(w?Math.max(w,y.getTime()+e.SEC):y.getTime()+e.SEC):void 0,new Date(Math.min(g,E.getTime()+e.SEC))];if(p&&O[V].getTime()===p[R].getTime()?(p[R]=O[R],T++):(p=O,k.push(p)),!y)break;u(t,x,S,y)}else k.push(I?new Date(Math.max(g,E)):o(x,S,E,w)),l(t,x,S,E);T--}for(var N=0,b=k.length;N<b;N++){var A=k[N];k[N]="[object Array]"===Object.prototype.toString.call(A)?[a(A[0]),a(A[1])]:a(A)}return 0===k.length?e.NEVER:1===n?k[0]:k}function a(t){if(t instanceof Date&&!isNaN(t.valueOf()))return new Date(t)}function r(t,e,n,a){for(var r=0,u=e.length;r<u;r++)n[r]=e[r].start(t,a)}function u(t,e,n,a){for(var r=D(t),u=0,i=e.length;u<i;u++)n[u]&&!r(n[u],a)&&(n[u]=e[u].start(t,a))}function i(t,n,a,r){for(var u=(D(t),0),i=n.length;u<i;u++){var v=n[u].start(t,r);a[u]=v?[v,n[u].end(t,v)]:e.NEVER}}function v(t,n,a,r){for(var u=D(t),i=0,v=n.length;i<v;i++)if(a[i]&&!u(a[i][0],r)){var l=n[i].start(t,r);a[i]=l?[l,n[i].end(t,l)]:e.NEVER}}function l(t,e,n,a){for(var r=0,u=e.length;r<u;r++)n[r]&&n[r].getTime()===a.getTime()&&(n[r]=e[r].start(t,e[r].tick(t,a)))}function o(t,e,n,a){for(var r,u=0,i=e.length;u<i;u++)if(e[u]&&e[u].getTime()===n.getTime()){var v=t[u].tickStart(n);if(a&&v<a)return a;(!r||v>r)&&(r=v)}return r}function d(t,e,n){for(var a,r=D(t),u=0,i=e.length;u<i;u++){var v=e[u];!v||r(v[0],n)||v[1]&&!r(v[1],n)||a&&!r(v[1],a)||(a=v[1])}return a}function f(t,e){for(var n,a=0,r=t.length;a<r;a++)!t[a]||n&&!e(n,t[a][0])||(n=t[a][0]);return n}function c(t,e,n,a,r){for(var u,i=D(t),v=0,l=e.length;v<l;v++){var o=n[v];if(o&&o.getTime()===a.getTime()){var d=e[v].end(t,o);if(r&&(!d||i(d,r)))return r;u&&!i(d,u)||(u=d)}}return u}function D(t){return"next"===t?function(t,e){return!e||t.getTime()>e.getTime()}:function(t,e){return!t||e.getTime()>t.getTime()}}function s(t,e){for(var n=t[0],a=1,r=t.length;a<r;a++)t[a]&&e(n,t[a])&&(n=t[a]);return n}if(!t)throw new Error("Missing schedule definition.");if(!t.schedules)throw new Error("Definition must include at least one schedule.");for(var x=[],g=t.schedules.length,M=[],m=t.exceptions?t.exceptions.length:0,w=0;w<g;w++)x.push(e.compile(t.schedules[w]));for(var h=0;h<m;h++)M.push(e.compile(t.exceptions[h]));return{isValid:function(t){return n("next",1,t,t)!==e.NEVER},next:function(t,e,a){return n("next",t||1,e,a)},prev:function(t,e,a){return n("prev",t||1,e,a)},nextRange:function(t,e,a){return n("next",t||1,e,a,!0)},prevRange:function(t,e,a){return n("prev",t||1,e,a,!0)}}},e.setTimeout=function(t,n){function a(){var e=Date.now(),n=u.next(2,e);if(!n[0])return void(r=void 0);var i=n[0].getTime()-e;i<1e3&&(i=n[1]?n[1].getTime()-e:1e3),r=i<2147483647?setTimeout(t,i):setTimeout(a,2147483647)}var r,u=e.schedule(n);return t&&a(),{isDone:function(){return!r},clear:function(){clearTimeout(r)}}},e.setInterval=function(t,n){function a(){u||(t(),r=e.setTimeout(a,n))}if(t){var r=e.setTimeout(a,n),u=r.isDone();return{isDone:function(){return r.isDone()},clear:function(){u=!0,r.clear()}}}},e.date={},e.date.timezone=function(t){e.date.build=t?function(t,e,n,a,r,u){return new Date(t,e,n,a,r,u)}:function(t,e,n,a,r,u){return new Date(Date.UTC(t,e,n,a,r,u))};var n=t?"get":"getUTC",a=Date.prototype;e.date.getYear=a[n+"FullYear"],e.date.getMonth=a[n+"Month"],e.date.getDate=a[n+"Date"],e.date.getDay=a[n+"Day"],e.date.getHour=a[n+"Hours"],e.date.getMin=a[n+"Minutes"],e.date.getSec=a[n+"Seconds"],e.date.isUTC=!t},e.date.UTC=function(){e.date.timezone(!1)},e.date.localTime=function(){e.date.timezone(!0)},e.date.UTC(),e.SEC=1e3,e.MIN=60*e.SEC,e.HOUR=60*e.MIN,e.DAY=24*e.HOUR,e.WEEK=7*e.DAY,e.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],e.NEVER=0,e.date.next=function(t,n,a,r,u,i){return e.date.build(t,void 0!==n?n-1:0,void 0!==a?a:1,r||0,u||0,i||0)},e.date.nextRollover=function(t,n,a,r){var u=a.val(t),i=a.extent(t)[1];return(n||i)<=u||n>i?new Date(r.end(t).getTime()+e.SEC):r.start(t)},e.date.prev=function(t,n,a,r,u,i){var v=arguments.length;return n=v<2?11:n-1,a=v<3?e.D.extent(e.date.next(t,n+1))[1]:a,r=v<4?23:r,u=v<5?59:u,i=v<6?59:i,e.date.build(t,n,a,r,u,i)},e.date.prevRollover=function(t,e,n,a){return e>=n.val(t)||!e?a.start(a.prev(t,a.val(t)-1)):a.start(t)},e.date.diffInDays=function(t,n){return Math.floor((Date.UTC(n.getFullYear(),n.getMonth(),n.getDate())-Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()))/e.DAY)},e.date.startOfWeek=function(t){var n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),a=n.getDay(),r=n.getTime()-a*e.DAY;return n.setTime(r),n},e.date.endOfWeek=function(t){var n=e.date.startOfWeek(t);return n.setTime(n.getTime()+e.WEEK-e.SEC),n},e.date.diffInMonths=function(t,e){var n=12*(e.getFullYear()-t.getFullYear())+(e.getMonth()-t.getMonth());return n<=0?0:n},e.date.startOfMonth=function(t){return new Date(t.getFullYear(),t.getMonth(),1)},e.date.endOfMonth=function(t){var n=new Date(t.getFullYear(),t.getMonth()+1,1);return n.setTime(n.getTime()-e.SEC),n};var n={weekDays:{},weekendDays:{}};return e.date.weekdaysInMonth=function(e){var a=e.getFullYear(),r=e.getMonth(),u=100*a+r;return(n[u]=n[u]||t(a,r)).weekDays},e.date.weekendDaysInMonth=function(e){var a=e.getFullYear(),r=e.getMonth(),u=100*a+r;return(n[u]=n[u]||t(a,r)).weekendDays},e}();