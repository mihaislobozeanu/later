later=function(){"use strict";function e(e,t){for(var n=new Date(e,t+1,0).getDate(),r=new Date(e,t,1).getDay()-1,a={weekDays:{values:[],map:{}},weekendDays:{values:[],map:{}}},u=-1,i=-1,o=1;o<=n;o++){var d=(o+r)%7;0==d||6==d?(a.weekendDays.map[o]={value:u=a.weekendDays.values.push(o)-1,valid:!0},a.weekDays.map[o]={value:i+1,valid:!1}):(a.weekDays.map[o]={value:i=a.weekDays.values.push(o)-1,valid:!0},a.weekendDays.map[o]={value:u+1,valid:!1})}return a}var t={version:"1.2.0"};Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var r=0;if(arguments.length>1&&(r=Number(arguments[1]),r!=r?r=0:0!=r&&r!=1/0&&r!=-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=n)return-1;for(var a=r>=0?r:Math.max(n-Math.abs(r),0);a<n;a++)if(a in t&&t[a]===e)return a;return-1}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),t.array={},t.array.sort=function(e,t){e.sort(function(e,t){return+e-+t}),t&&0===e[0]&&e.push(e.shift())},t.array.next=function(e,t,n){for(var r,a=0!==n[0],u=0,i=t.length-1;i>-1;--i){if((r=t[i])===e)return r;if(!(r>e||0===r&&a&&n[1]>e))break;u=i}return t[u]},t.array.nextInvalid=function(e,t,n){for(var r=n[0],a=n[1],u=t.length,i=0===t[u-1]&&0!==r?a:0,o=e,d=t.indexOf(e),f=o;o===(t[d]||i);)if(o++,o>a&&(o=r),d++,d===u&&(d=0),o===f)return;return o},t.array.prev=function(e,t,n){for(var r,a=t.length,u=0!==n[0],i=a-1,o=0;o<a;o++){if((r=t[o])===e)return r;if(!(r<e||0===r&&u&&n[1]<e))break;i=o}return t[i]},t.array.prevInvalid=function(e,t,n){for(var r=n[0],a=n[1],u=t.length,i=0===t[u-1]&&0!==r?a:0,o=e,d=t.indexOf(e),f=o;o===(t[d]||i);)if(o--,o<r&&(o=a),d--,-1===d&&(d=u-1),o===f)return;return o},t.day=t.D={name:"day",range:86400,val:function(e){return e.D||(e.D=t.date.getDate.call(e))},isValid:function(e,n){return t.D.val(e)===(n||t.D.extent(e)[1])},extent:function(e){if(e.DExtent)return e.DExtent;var n=t.M.val(e),r=t.DAYS_IN_MONTH[n-1];return 2===n&&366===t.dy.extent(e)[1]&&(r+=1),e.DExtent=[1,r]},start:function(e){return e.DStart||(e.DStart=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)))},end:function(e){return e.DEnd||(e.DEnd=t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e)))},next:function(e,n){n=n>t.D.extent(e)[1]?1:n;var r=t.date.nextRollover(e,n,t.D,t.M),a=t.D.extent(r)[1];return n=n>a?1:n||a,t.date.next(t.Y.val(r),t.M.val(r),n)},prev:function(e,n){var r=t.date.prevRollover(e,n,t.D,t.M),a=t.D.extent(r)[1];return t.date.prev(t.Y.val(r),t.M.val(r),n>a?a:n||a)}},t.dayEx=t.DX={rangeStart:new Date("2015-01-01"),rangeEnd:new Date("2050-01-01"),name:"dayEx",range:86400,val:function(e){return e.DX||(e.DX=t.date.diffInDays(t.DX.rangeStart,e))},isValid:function(e,n){return t.DX.val(e)===(n||t.DX.extent(e)[1])},extent:function(e){if(e.DXExtent)return e.DXExtent;var n=Math.floor(t.DX.rangeEnd.getTime()/t.DAY)-Math.floor(t.DX.rangeStart.getTime()/t.DAY);return e.DXExtent=[1,n]},start:function(e){return e.DXStart||(e.DXStart=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)))},end:function(e){return e.DXEnd||(e.DXEnd=t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e)))},next:function(e,n){return new Date(t.DX.rangeStart.getTime()+n*t.DAY)},prev:function(e,n){return new Date(t.DX.rangeStart.getTime()+n*t.DAY)}},t.weekday=t.WD={name:"weekday",range:86400,val:function(e){if(e.WD)return e.WD;var n=t.WD.weekdaysInMonth(e),r=t.date.getDate.call(e);return e.WD=n.map[r].value+1},weekdaysInMonth:function(e){return e.weekdaysInMonth||(e.weekdaysInMonth=t.date.weekdaysInMonth(e))},isValid:function(e,n){if(t.WD.val(e)===(n||t.WD.extent(e)[1])){var r=t.WD.weekdaysInMonth(e),a=t.date.getDate.call(e);return r.map[a].valid}return!1},extent:function(e){if(e.WDExtent)return e.WDExtent;var n=t.WD.weekdaysInMonth(e);return e.WDExtent=[1,n.values.length]},start:function(e){return e.WDStart||(e.WDStart=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)))},end:function(e){return e.WDEnd||(e.WDEnd=t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e)))},next:function(e,n){var r=t.WD.extent(e)[1];n=n>r?1:n;var a=t.WD.weekdaysInMonth(e),u=a.values[(n||r)-1],i=t.date.nextRollover(e,u,t.D,t.M);return r=t.WD.extent(i)[1],n=n>r?1:n||r,a=t.WD.weekdaysInMonth(i),u=a.values[n-1],t.date.next(t.Y.val(i),t.M.val(i),u)},prev:function(e,n){var r=t.WD.weekdaysInMonth(e),a=r.values[(n||i)-1],u=t.date.prevRollover(e,a,t.D,t.M),i=t.WD.extent(u)[1];return n=n>i?i:n||i,r=t.WD.weekdaysInMonth(u),a=r.values[n-1],t.date.prev(t.Y.val(u),t.M.val(u),a)}},t.weekendDay=t.WED={name:"weekendDay",range:86400,val:function(e){if(e.WED)return e.WED;var n=t.WED.weekendDaysInMonth(e),r=t.date.getDate.call(e);return e.WED=n.map[r].value+1},weekendDaysInMonth:function(e){return e.weekendDaysInMonth||(e.weekendDaysInMonth=t.date.weekendDaysInMonth(e))},isValid:function(e,n){if(t.WED.val(e)===(n||t.WED.extent(e)[1])){var r=t.WED.weekendDaysInMonth(e),a=t.date.getDate.call(e);return r.map[a].valid}return!1},extent:function(e){if(e.WDExtent)return e.WDExtent;var n=t.WED.weekendDaysInMonth(e);return e.WDExtent=[1,n.values.length]},start:function(e){return e.WDStart||(e.WDStart=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)))},end:function(e){return e.WDEnd||(e.WDEnd=t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e)))},next:function(e,n){var r=t.WED.extent(e)[1];n=n>r?1:n;var a=t.WED.weekendDaysInMonth(e),u=a.values[(n||r)-1],i=t.date.nextRollover(e,u,t.D,t.M);return r=t.WED.extent(i)[1],n=n>r?1:n||r,a=t.WED.weekendDaysInMonth(i),u=a.values[n-1],t.date.next(t.Y.val(i),t.M.val(i),u)},prev:function(e,n){var r=t.WD.weekendDaysInMonth(e),a=r.values[(n||i)-1],u=t.date.prevRollover(e,a,t.D,t.M),i=t.WD.extent(u)[1];return n=n>i?i:n||i,r=t.WD.weekendDaysInMonth(u),a=r.values[n-1],t.date.prev(t.Y.val(u),t.M.val(u),a)}},t.dayOfWeekCount=t.dc={name:"day of week count",range:604800,val:function(e){return e.dc||(e.dc=Math.floor((t.D.val(e)-1)/7)+1)},isValid:function(e,n){return t.dc.val(e)===n||0===n&&t.D.val(e)>t.D.extent(e)[1]-7},extent:function(e){return e.dcExtent||(e.dcExtent=[1,Math.ceil(t.D.extent(e)[1]/7)])},start:function(e){return e.dcStart||(e.dcStart=t.date.next(t.Y.val(e),t.M.val(e),Math.max(1,7*(t.dc.val(e)-1)+1||1)))},end:function(e){return e.dcEnd||(e.dcEnd=t.date.prev(t.Y.val(e),t.M.val(e),Math.min(7*t.dc.val(e),t.D.extent(e)[1])))},next:function(e,n){n=n>t.dc.extent(e)[1]?1:n;var r=t.date.nextRollover(e,n,t.dc,t.M);n=n>t.dc.extent(r)[1]?1:n;var a=t.date.next(t.Y.val(r),t.M.val(r),0===n?t.D.extent(r)[1]-6:1+7*(n-1));return a.getTime()<=e.getTime()?(r=t.M.next(e,t.M.val(e)+1),t.date.next(t.Y.val(r),t.M.val(r),0===n?t.D.extent(r)[1]-6:1+7*(n-1))):a},prev:function(e,n){var r=t.date.prevRollover(e,n,t.dc,t.M),a=t.dc.extent(r)[1];return n=n>a?a:n||a,t.dc.end(t.date.prev(t.Y.val(r),t.M.val(r),1+7*(n-1)))}},t.dayOfWeek=t.dw=t.d={name:"day of week",range:86400,val:function(e){return e.dw||(e.dw=t.date.getDay.call(e)+1)},isValid:function(e,n){return t.dw.val(e)===(n||7)},extent:function(){return[1,7]},start:function(e){return t.D.start(e)},end:function(e){return t.D.end(e)},next:function(e,n){return n=n>7?1:n||7,t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)+(n-t.dw.val(e))+(n<=t.dw.val(e)?7:0))},prev:function(e,n){return n=n>7?7:n||7,t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e)+(n-t.dw.val(e))+(n>=t.dw.val(e)?-7:0))}},t.dayOfYear=t.dy={name:"day of year",range:86400,val:function(e){return e.dy||(e.dy=Math.ceil(1+(t.D.start(e).getTime()-t.Y.start(e).getTime())/t.DAY))},isValid:function(e,n){return t.dy.val(e)===(n||t.dy.extent(e)[1])},extent:function(e){var n=t.Y.val(e);return e.dyExtent||(e.dyExtent=[1,n%4?365:366])},start:function(e){return t.D.start(e)},end:function(e){return t.D.end(e)},next:function(e,n){n=n>t.dy.extent(e)[1]?1:n;var r=t.date.nextRollover(e,n,t.dy,t.Y),a=t.dy.extent(r)[1];return n=n>a?1:n||a,t.date.next(t.Y.val(r),t.M.val(r),n)},prev:function(e,n){var r=t.date.prevRollover(e,n,t.dy,t.Y),a=t.dy.extent(r)[1];return n=n>a?a:n||a,t.date.prev(t.Y.val(r),t.M.val(r),n)}},t.hour=t.h={name:"hour",range:3600,val:function(e){return e.h||(e.h=t.date.getHour.call(e))},isValid:function(e,n){return t.h.val(e)===n},extent:function(){return[0,23]},start:function(e){return e.hStart||(e.hStart=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e)))},end:function(e){return e.hEnd||(e.hEnd=t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e)))},next:function(e,n){n=n>23?0:n;var r=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)+(n<=t.h.val(e)?1:0),n);return!t.date.isUTC&&r.getTime()<=e.getTime()&&(r=t.date.next(t.Y.val(r),t.M.val(r),t.D.val(r),n+1)),r},prev:function(e,n){return n=n>23?23:n,t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e)+(n>=t.h.val(e)?-1:0),n)}},t.minute=t.m={name:"minute",range:60,val:function(e){return e.m||(e.m=t.date.getMin.call(e))},isValid:function(e,n){return t.m.val(e)===n},extent:function(e){return[0,59]},start:function(e){return e.mStart||(e.mStart=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e),t.m.val(e)))},end:function(e){return e.mEnd||(e.mEnd=t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e),t.m.val(e)))},next:function(e,n){var r=t.m.val(e),a=t.s.val(e),u=n>59?60-r:n<=r?60-r+n:n-r,i=new Date(e.getTime()+u*t.MIN-a*t.SEC);return!t.date.isUTC&&i.getTime()<=e.getTime()&&(i=new Date(e.getTime()+(u+120)*t.MIN-a*t.SEC)),i},prev:function(e,n){return n=n>59?59:n,t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e)+(n>=t.m.val(e)?-1:0),n)}},t.month=t.M={name:"month",range:2629740,val:function(e){return e.M||(e.M=t.date.getMonth.call(e)+1)},isValid:function(e,n){return t.M.val(e)===(n||12)},extent:function(){return[1,12]},start:function(e){return e.MStart||(e.MStart=t.date.next(t.Y.val(e),t.M.val(e)))},end:function(e){return e.MEnd||(e.MEnd=t.date.prev(t.Y.val(e),t.M.val(e)))},next:function(e,n){return n=n>12?1:n||12,t.date.next(t.Y.val(e)+(n>t.M.val(e)?0:1),n)},prev:function(e,n){return n=n>12?12:n||12,t.date.prev(t.Y.val(e)-(n>=t.M.val(e)?1:0),n)}},t.monthEx=t.MX={name:"monthEx",range:2629740,val:function(e){return e.MX||(e.MX=t.date.diffInMonths(t.MX.start(t.DX.rangeStart),t.MX.start(e)))},isValid:function(e,n){return t.MX.val(e)===(n||t.MX.extent(e)[1])},extent:function(e){if(e.MXExtent)return e.MXExtent;var n=t.date.diffInMonths(t.MX.start(t.DX.rangeStart),t.MX.start(t.DX.rangeEnd));return e.MXExtent=[1,n]},start:function(e){return e.MXStart||(e.MXStart=t.date.startOfMonth(e))},end:function(e){return e.MXEnd||(e.MXEnd=t.date.endOfMonth(e))},next:function(e,n){var r=new Date(t.MX.start(t.DX.rangeStart));return r.setMonth(r.getMonth()+n),r},prev:function(e,n){var r=new Date(t.MX.start(t.DX.rangeStart));return r.setMonth(r.getMonth()+n),r.setTime(r.getTime()-t.SEC),r}},t.second=t.s={name:"second",range:1,val:function(e){return e.s||(e.s=t.date.getSec.call(e))},isValid:function(e,n){return t.s.val(e)===n},extent:function(){return[0,59]},start:function(e){return e},end:function(e){return e},next:function(e,n){var r=t.s.val(e),a=n>59?60-r:n<=r?60-r+n:n-r,u=new Date(e.getTime()+a*t.SEC);return!t.date.isUTC&&u.getTime()<=e.getTime()&&(u=new Date(e.getTime()+(a+7200)*t.SEC)),u},prev:function(e,n,r){return n=n>59?59:n,t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e),t.h.val(e),t.m.val(e)+(n>=t.s.val(e)?-1:0),n)}},t.time=t.t={name:"time",range:1,val:function(e){return e.t||(e.t=3600*t.h.val(e)+60*t.m.val(e)+t.s.val(e))},isValid:function(e,n){return t.t.val(e)===n},extent:function(){return[0,86399]},start:function(e){return e},end:function(e){return e},next:function(e,n){n=n>86399?0:n;var r=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)+(n<=t.t.val(e)?1:0),0,0,n);return!t.date.isUTC&&r.getTime()<e.getTime()&&(r=t.date.next(t.Y.val(r),t.M.val(r),t.D.val(r),t.h.val(r),t.m.val(r),n+7200)),r},prev:function(e,n){return n=n>86399?86399:n,t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)+(n>=t.t.val(e)?-1:0),0,0,n)}},t.weekOfMonth=t.wm={name:"week of month",range:604800,val:function(e){return e.wm||(e.wm=(t.D.val(e)+(t.dw.val(t.M.start(e))-1)+(7-t.dw.val(e)))/7)},isValid:function(e,n){return t.wm.val(e)===(n||t.wm.extent(e)[1])},extent:function(e){return e.wmExtent||(e.wmExtent=[1,(t.D.extent(e)[1]+(t.dw.val(t.M.start(e))-1)+(7-t.dw.val(t.M.end(e))))/7])},start:function(e){return e.wmStart||(e.wmStart=t.date.next(t.Y.val(e),t.M.val(e),Math.max(t.D.val(e)-t.dw.val(e)+1,1)))},end:function(e){return e.wmEnd||(e.wmEnd=t.date.prev(t.Y.val(e),t.M.val(e),Math.min(t.D.val(e)+(7-t.dw.val(e)),t.D.extent(e)[1])))},next:function(e,n){n=n>t.wm.extent(e)[1]?1:n;var r=t.date.nextRollover(e,n,t.wm,t.M),a=t.wm.extent(r)[1];return n=n>a?1:n||a,t.date.next(t.Y.val(r),t.M.val(r),Math.max(1,7*(n-1)-(t.dw.val(r)-2)))},prev:function(e,n){var r=t.date.prevRollover(e,n,t.wm,t.M),a=t.wm.extent(r)[1];return n=n>a?a:n||a,t.wm.end(t.date.next(t.Y.val(r),t.M.val(r),Math.max(1,7*(n-1)-(t.dw.val(r)-2))))}},t.weekOfYear=t.wy={name:"week of year (ISO)",range:604800,val:function(e){if(e.wy)return e.wy;var n=t.dw.next(t.wy.start(e),5),r=t.dw.next(t.Y.prev(n,t.Y.val(n)-1),5);return e.wy=1+Math.ceil((n.getTime()-r.getTime())/t.WEEK)},isValid:function(e,n){return t.wy.val(e)===(n||t.wy.extent(e)[1])},extent:function(e){if(e.wyExtent)return e.wyExtent;var n=t.dw.next(t.wy.start(e),5),r=t.dw.val(t.Y.start(n)),a=t.dw.val(t.Y.end(n));return e.wyExtent=[1,5===r||5===a?53:52]},start:function(e){return e.wyStart||(e.wyStart=t.date.next(t.Y.val(e),t.M.val(e),t.D.val(e)-(t.dw.val(e)>1?t.dw.val(e)-2:6)))},end:function(e){return e.wyEnd||(e.wyEnd=t.date.prev(t.Y.val(e),t.M.val(e),t.D.val(e)+(t.dw.val(e)>1?8-t.dw.val(e):0)))},next:function(e,n){n=n>t.wy.extent(e)[1]?1:n;var r=t.dw.next(t.wy.start(e),5),a=t.date.nextRollover(r,n,t.wy,t.Y);1!==t.wy.val(a)&&(a=t.dw.next(a,2));var u=t.wy.extent(a)[1],i=t.wy.start(a);return n=n>u?1:n||u,t.date.next(t.Y.val(i),t.M.val(i),t.D.val(i)+7*(n-1))},prev:function(e,n){var r=t.dw.next(t.wy.start(e),5),a=t.date.prevRollover(r,n,t.wy,t.Y);1!==t.wy.val(a)&&(a=t.dw.next(a,2));var u=t.wy.extent(a)[1],i=t.wy.end(a);return n=n>u?u:n||u,t.wy.end(t.date.next(t.Y.val(i),t.M.val(i),t.D.val(i)+7*(n-1)))}},t.weekEx=t.WX={name:"weekEx",range:604800,val:function(e){return e.WX?e.WX:e.WX=Math.ceil(t.date.diffInDays(t.WX.start(t.DX.rangeStart),t.WX.start(e))/7)},isValid:function(e,n){return t.WX.val(e)===(n||t.WX.extent(e)[1])},extent:function(e){if(e.WXExtent)return e.WXExtent;var n=Math.floor(t.date.diffInDays(t.WX.start(t.DX.rangeStart),t.WX.start(t.DX.rangeEnd))/7);return e.WXExtent=[1,n]},start:function(e){return e.WXStart||(e.WXStart=t.date.startOfWeek(e))},end:function(e){return e.WXEnd||(e.WXEnd=t.date.endOfWeek(e))},next:function(e,n){return new Date(t.WX.start(t.DX.rangeStart).getTime()+n*t.WEEK)},prev:function(e,n){var r=new Date(t.WX.start(t.DX.rangeStart).getTime()+n*t.WEEK);return r.setTime(r.getTime()-t.SEC),r}},t.year=t.Y={name:"year",range:31556900,val:function(e){return e.Y||(e.Y=t.date.getYear.call(e))},isValid:function(e,n){return t.Y.val(e)===n},extent:function(){return[1970,2099]},start:function(e){return e.YStart||(e.YStart=t.date.next(t.Y.val(e)))},end:function(e){return e.YEnd||(e.YEnd=t.date.prev(t.Y.val(e)))},next:function(e,n){return n>t.Y.val(e)&&n<=t.Y.extent()[1]?t.date.next(n):t.NEVER},prev:function(e,n){return n<t.Y.val(e)&&n>=t.Y.extent()[0]?t.date.prev(n):t.NEVER}},t.fullDate=t.fd={name:"full date",range:1,val:function(e){return e.fd||(e.fd=e.getTime())},isValid:function(e,n){return t.fd.val(e)===n},extent:function(){return[0,3250368e7]},start:function(e){return e},end:function(e){return e},next:function(e,n){return t.fd.val(e)<n?new Date(n):t.NEVER},prev:function(e,n){return t.fd.val(e)>n?new Date(n):t.NEVER}},t.modifier={},t.modifier.after=t.modifier.a=function(e,t){var n=t[0];return{name:"after "+e.name,range:(e.extent(new Date)[1]-n)*e.range,val:e.val,isValid:function(e,t){return this.val(e)>=n},extent:e.extent,start:e.start,end:e.end,next:function(t,r){return r!=n&&(r=e.extent(t)[0]),e.next(t,r)},prev:function(t,r){return r=r===n?e.extent(t)[1]:n-1,e.prev(t,r)}}},t.modifier.before=t.modifier.b=function(e,t){var n=t[t.length-1];return{name:"before "+e.name,range:e.range*(n-1),val:e.val,isValid:function(e,t){return this.val(e)<n},extent:e.extent,start:e.start,end:e.end,next:function(t,r){return r=r===n?e.extent(t)[0]:n,e.next(t,r)},prev:function(t,r){return r=r===n?n-1:e.extent(t)[1],e.prev(t,r)}}},t.compile=function(e){function n(e){return"next"===e?function(e,t){return e.getTime()>t.getTime()}:function(e,t){return t.getTime()>e.getTime()}}var r,a=[],u=0;for(var i in e){var o=i.split("_"),d=o[0],f=o[1],v=e[i],l=f?t.modifier[f](t[d],v):t[d];a.push({constraint:l,vals:v}),u++}return a.sort(function(e,t){var n=e.constraint.range,r=t.constraint.range;return r<n?-1:r>n?1:0}),r=a[u-1].constraint,{start:function(e,n){for(var i,o=n,d=t.array[e],f=1e3;f--&&!i&&o;){i=!0;for(var v=0;v<u;v++){var l=a[v].constraint,c=l.val(o),s=l.extent(o),h=d(c,a[v].vals,s);if(!l.isValid(o,h)){o=l[e](o,h),i=!1;break}}}return o!==t.NEVER&&(o="next"===e?r.start(o):r.end(o)),o},end:function(e,r){for(var i,o=t.array[e+"Invalid"],d=n(e),f=u-1;f>=0;f--){var v,l=a[f].constraint,c=l.val(r),s=l.extent(r),h=o(c,a[f].vals,s);void 0!==h&&(!(v=l[e](r,h))||i&&!d(i,v)||(i=v))}return i},tick:function(e,n){return new Date("next"===e?r.end(n).getTime()+t.SEC:r.start(n).getTime()-t.SEC)},tickStart:function(e){return r.start(e)}}},t.schedule=function(e){function n(e,n,x,g,y){var M,p,E,k=s(e),Y=n,W=1e3,b=[],T=[],O=[],X="next"===e,S=X?0:1,I=X?1:0;if(!(x=x?new Date(x):new Date)||!x.getTime())throw new Error("Invalid start date.");for(a(e,D,b,x),i(e,m,T,x);W--&&Y&&(M=h(b,k))&&(!g||!k(M,g));)if(w&&(o(e,m,T,M),p=v(e,T,M)))u(e,D,b,p);else{if(y){var N=l(T,k);p=c(e,D,b,M,N);var R=X?[new Date(Math.max(x,M)),p?new Date(g?Math.min(p,g):p):void 0]:[p?new Date(g?Math.max(g,p.getTime()+t.SEC):p.getTime()+t.SEC):void 0,new Date(Math.min(x,M.getTime()+t.SEC))];if(E&&R[S].getTime()===E[I].getTime()?(E[I]=R[I],Y++):(E=R,O.push(E)),!p)break;u(e,D,b,p)}else O.push(X?new Date(Math.max(x,M)):f(D,b,M,g)),d(e,D,b,M);Y--}for(var C=0,V=O.length;C<V;C++){var A=O[C];O[C]="[object Array]"===Object.prototype.toString.call(A)?[r(A[0]),r(A[1])]:r(A)}return 0===O.length?t.NEVER:1===n?O[0]:O}function r(e){if(e instanceof Date&&!isNaN(e.valueOf()))return new Date(e)}function a(e,t,n,r){for(var a=0,u=t.length;a<u;a++)n[a]=t[a].start(e,r)}function u(e,t,n,r){for(var a=s(e),u=0,i=t.length;u<i;u++)n[u]&&!a(n[u],r)&&(n[u]=t[u].start(e,r))}function i(e,n,r,a){for(var u=(s(e),0),i=n.length;u<i;u++){var o=n[u].start(e,a);r[u]=o?[o,n[u].end(e,o)]:t.NEVER}}function o(e,n,r,a){for(var u=s(e),i=0,o=n.length;i<o;i++)if(r[i]&&!u(r[i][0],a)){var d=n[i].start(e,a);r[i]=d?[d,n[i].end(e,d)]:t.NEVER}}function d(e,t,n,r){for(var a=0,u=t.length;a<u;a++)n[a]&&n[a].getTime()===r.getTime()&&(n[a]=t[a].start(e,t[a].tick(e,r)))}function f(e,t,n,r){for(var a,u=0,i=t.length;u<i;u++)if(t[u]&&t[u].getTime()===n.getTime()){var o=e[u].tickStart(n);if(r&&o<r)return r;(!a||o>a)&&(a=o)}return a}function v(e,t,n){for(var r,a=s(e),u=0,i=t.length;u<i;u++){var o=t[u];!o||a(o[0],n)||o[1]&&!a(o[1],n)||r&&!a(o[1],r)||(r=o[1])}return r}function l(e,t){for(var n,r=0,a=e.length;r<a;r++)!e[r]||n&&!t(n,e[r][0])||(n=e[r][0]);return n}function c(e,t,n,r,a){for(var u,i=s(e),o=0,d=t.length;o<d;o++){var f=n[o];if(f&&f.getTime()===r.getTime()){var v=t[o].end(e,f);if(a&&(!v||i(v,a)))return a;u&&!i(v,u)||(u=v)}}return u}function s(e){return"next"===e?function(e,t){return!t||e.getTime()>t.getTime()}:function(e,t){return!e||t.getTime()>e.getTime()}}function h(e,t){for(var n=e[0],r=1,a=e.length;r<a;r++)e[r]&&t(n,e[r])&&(n=e[r]);return n}if(!e)throw new Error("Missing schedule definition.");if(!e.schedules)throw new Error("Definition must include at least one schedule.");for(var D=[],x=e.schedules.length,m=[],w=e.exceptions?e.exceptions.length:0,g=0;g<x;g++)D.push(t.compile(e.schedules[g]));for(var y=0;y<w;y++)m.push(t.compile(e.exceptions[y]));return{isValid:function(e){return n("next",1,e,e)!==t.NEVER},next:function(e,t,r){return n("next",e||1,t,r)},prev:function(e,t,r){return n("prev",e||1,t,r)},nextRange:function(e,t,r){return n("next",e||1,t,r,!0)},prevRange:function(e,t,r){return n("prev",e||1,t,r,!0)}}},t.setTimeout=function(e,n){function r(){var t=Date.now(),n=u.next(2,t);if(!n[0])return void(a=void 0);var i=n[0].getTime()-t;i<1e3&&(i=n[1]?n[1].getTime()-t:1e3),a=i<2147483647?setTimeout(e,i):setTimeout(r,2147483647)}var a,u=t.schedule(n);return e&&r(),{isDone:function(){return!a},clear:function(){clearTimeout(a)}}},t.setInterval=function(e,n){function r(){u||(e(),a=t.setTimeout(r,n))}if(e){var a=t.setTimeout(r,n),u=a.isDone();return{isDone:function(){return a.isDone()},clear:function(){u=!0,a.clear()}}}},t.date={},t.date.timezone=function(e){t.date.build=e?function(e,t,n,r,a,u){return new Date(e,t,n,r,a,u)}:function(e,t,n,r,a,u){return new Date(Date.UTC(e,t,n,r,a,u))};var n=e?"get":"getUTC",r=Date.prototype;t.date.getYear=r[n+"FullYear"],t.date.getMonth=r[n+"Month"],t.date.getDate=r[n+"Date"],t.date.getDay=r[n+"Day"],t.date.getHour=r[n+"Hours"],t.date.getMin=r[n+"Minutes"],t.date.getSec=r[n+"Seconds"],t.date.isUTC=!e},t.date.UTC=function(){t.date.timezone(!1)},t.date.localTime=function(){t.date.timezone(!0)},t.date.UTC(),t.SEC=1e3,t.MIN=60*t.SEC,t.HOUR=60*t.MIN,t.DAY=24*t.HOUR,t.WEEK=7*t.DAY,t.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],t.NEVER=0,t.date.next=function(e,n,r,a,u,i){return t.date.build(e,void 0!==n?n-1:0,void 0!==r?r:1,a||0,u||0,i||0)},t.date.nextRollover=function(e,n,r,a){var u=r.val(e),i=r.extent(e)[1];return(n||i)<=u||n>i?new Date(a.end(e).getTime()+t.SEC):a.start(e)},t.date.prev=function(e,n,r,a,u,i){var o=arguments.length;return n=o<2?11:n-1,r=o<3?t.D.extent(t.date.next(e,n+1))[1]:r,a=o<4?23:a,u=o<5?59:u,i=o<6?59:i,t.date.build(e,n,r,a,u,i)},t.date.prevRollover=function(e,t,n,r){return t>=n.val(e)||!t?r.start(r.prev(e,r.val(e)-1)):r.start(e)},t.date.diffInDays=function(e,n){return Math.floor((Date.UTC(n.getFullYear(),n.getMonth(),n.getDate())-Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))/t.DAY)},t.date.startOfWeek=function(e){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=n.getDay(),a=n.getTime()-r*t.DAY;return n.setTime(a),n},t.date.endOfWeek=function(e){var n=t.date.startOfWeek(e);return n.setTime(n.getTime()+t.WEEK-t.SEC),n},t.date.diffInMonths=function(e,t){var n=12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth());return n<=0?0:n},t.date.startOfMonth=function(e){return new Date(e.getFullYear(),e.getMonth(),1)},t.date.endOfMonth=function(e){var n=new Date(e.getFullYear(),e.getMonth()+1,1);return n.setTime(n.getTime()-t.SEC),n};var n={weekDays:{},weekendDays:{}};return t.date.weekdaysInMonth=function(t){var r=t.getFullYear(),a=t.getMonth(),u=100*r+a;return(n[u]=n[u]||e(r,a)).weekDays},t.date.weekendDaysInMonth=function(t){var r=t.getFullYear(),a=t.getMonth(),u=100*r+a;return(n[u]=n[u]||e(r,a)).weekendDays},t.parse={},t.parse.cron=function(e,t){function n(e,t,n){return isNaN(e)?l[e]||null:Math.min(+e+(t||0),n||9999)}function r(e){var t,n={};for(t in e)"dc"!==t&&"d"!==t&&(n[t]=e[t].slice(0));return n}function a(e,t,n,r,a){var u=n;for(e[t]||(e[t]=[]);u<=r;)e[t].indexOf(u)<0&&e[t].push(u),u+=a||1;e[t].sort(function(e,t){return e-t})}function u(e,t,n,u){(t.d&&!t.dc||t.dc&&t.dc.indexOf(u)<0)&&(e.push(r(t)),t=e[e.length-1]),a(t,"d",n,n),a(t,"dc",u,u)}function i(e,t,n){var r={},u={};1===n?(a(t,"D",1,3),a(t,"d",l.MON,l.FRI),a(r,"D",2,2),a(r,"d",l.TUE,l.FRI),a(u,"D",3,3),a(u,"d",l.TUE,l.FRI)):(a(t,"D",n-1,n+1),a(t,"d",l.MON,l.FRI),a(r,"D",n-1,n-1),a(r,"d",l.MON,l.THU),a(u,"D",n+1,n+1),a(u,"d",l.TUE,l.FRI)),e.exceptions.push(r),e.exceptions.push(u)}function o(e,t,r,u,i,o){var d=e.split("/"),f=+d[1],v=d[0];if("*"!==v&&"0"!==v){var l=v.split("-");u=n(l[0],o,i),i=n(l[1],o,i)||i}a(t,r,u,i,f)}function d(e,t,r,d,f,v){var l,c,s=t.schedules,h=s[s.length-1];"L"===e&&(e=d-1),null!==(l=n(e,v,f))?a(h,r,l,l):null!==(l=n(e.replace("W",""),v,f))?i(t,h,l):null!==(l=n(e.replace("L",""),v,f))?u(s,h,l,d-1):2===(c=e.split("#")).length?(l=n(c[0],v,f),u(s,h,l,n(c[1]))):o(e,h,r,d,f,v)}function f(e){return e.indexOf("#")>-1||e.indexOf("L")>0}function v(e,t){return f(e)&&!f(t)?1:e-t}var l={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12,SUN:1,MON:2,TUE:3,WED:4,THU:5,FRI:6,SAT:7},c={"* * * * * *":"0/1 * * * * *","@YEARLY":"0 0 1 1 *","@ANNUALLY":"0 0 1 1 *","@MONTHLY":"0 0 1 * *","@WEEKLY":"0 0 * * 0","@DAILY":"0 0 * * *","@HOURLY":"0 * * * *"},s={s:[0,0,59],m:[1,0,59],h:[2,0,23],D:[3,1,31],M:[4,1,12],Y:[6,1970,2099],d:[5,1,7,1]},h=function(e){var t=e.toUpperCase();return c[t]||t}(e);return function(e){var t,n,r,a,u={schedules:[{}],exceptions:[]},i=e.replace(/(\s)+/g," ").split(" ");for(t in s)if(n=s[t],(r=i[n[0]])&&"*"!==r&&"?"!==r){a=r.split(",").sort(v);var o,f=a.length;for(o=0;o<f;o++)d(a[o],u,t,n[1],n[2],n[3])}return u}(t?h:"0 "+h)},t.parse.recur=function(){function e(e,t,l){if(e=i?e+"_"+i:e,n||(s.push({}),n=s[0]),n[e]||(n[e]=[]),r=n[e],u){for(a=[],f=t;f<=l;f+=u)a.push(f);v={n:e,x:u,c:r.length,m:l}}a=o?[t]:d?[l]:a;var c=a.length;for(f=0;f<c;f+=1){var h=a[f];r.indexOf(h)<0&&r.push(h)}a=u=i=o=d=0}var n,r,a,u,i,o,d,f,v,l=[],c=[],s=l;return{schedules:l,exceptions:c,on:function(){return a=arguments[0]instanceof Array?arguments[0]:arguments,this},every:function(e){return u=e||1,this},after:function(e){return i="a",a=[e],this},before:function(e){return i="b",a=[e],this},first:function(){return o=1,this},last:function(){return d=1,this},time:function(){for(var t=0,n=a.length;t<n;t++){var r=a[t].split(":");r.length<3&&r.push(0),a[t]=3600*+r[0]+60*+r[1]+ +r[2]}return e("t"),this},second:function(){return e("s",0,59),this},minute:function(){return e("m",0,59),this},hour:function(){return e("h",0,23),this},dayOfMonth:function(){return e("D",1,d?0:31),this},weekdayOfMonth:function(){return e("WD",1,d?0:23),this},weekendDayOfMonth:function(){return e("WED",1,d?0:23),this},dayOfWeek:function(){return e("d",1,7),this},onWeekend:function(){return a=[1,7],this.dayOfWeek()},onWeekday:function(){return a=[2,3,4,5,6],this.dayOfWeek()},dayOfWeekCount:function(){return e("dc",1,d?0:5),this},dayOfYear:function(){return e("dy",1,d?0:366),this},dayEx:function(){var n=t.DX.extent(new Date);return e("DX",n[0],n[1]),this},weekOfMonth:function(){return e("wm",1,d?0:5),this},weekOfYear:function(){return e("wy",1,d?0:53),this},weekEx:function(){var n=t.WX.extent(new Date);return e("WX",n[0],n[1]),this},month:function(){return e("M",1,12),this},monthEx:function(){var n=t.MX.extent(new Date);return e("MX",n[0],n[1]),this},year:function(){return e("Y",1970,2450),this},fullDate:function(){for(var t=0,n=a.length;t<n;t++)a[t]=a[t].getTime();return e("fd"),this},customModifier:function(e,n){if(!t.modifier[e])throw new Error("Custom modifier "+e+" not recognized!");return i=e,a=arguments[1]instanceof Array?arguments[1]:[arguments[1]],this},customPeriod:function(n){var r=t[n];if(!r)throw new Error("Custom time period "+n+" not recognized!");return e(n,r.extent(new Date)[0],r.extent(new Date)[1]),this},reference:function(e){e=new Date(e);var n=t[v.n].val(e)%v.x;return this.between(n,v.m)},startingOn:function(e){return this.between(e,v.m)},between:function(t,r){return n[v.n]=n[v.n].splice(0,v.c),u=v.x,e(v.n,t,r),this},and:function(){return n=s[s.push({})-1],this},except:function(){return s=c,n=null,this}}},t.parse.text=function(e){function n(e,t,n,r){return{startPos:e,endPos:t,text:n,type:r}}function r(e){var t,r,a,u,i,o,d=e instanceof Array?e:[e],f=/\s+/;for(d.push(f),i=x;!t||t.type===f;){o=-1,r=m.substring(i),t=n(i,i,m.split(f)[0]);var v,l=d.length;for(v=0;v<l;v++)u=d[v],(a=u.exec(r))&&0===a.index&&a[0].length>o&&(o=a[0].length,t=n(i,i+o,r.substring(0,o),u));t.type===f&&(i=t.endPos)}return t}function a(e){var t=r(e);return x=t.endPos,t}function u(e){for(var t=+c(e),n=v(w.through)?+c(e):t,r=[],a=t;a<=n;a++)r.push(a);return r}function i(e){for(var t=u(e);v(w.and);)t=t.concat(u(e));return t}function o(e){var t,n,r,a;v(w.weekend)?e.on(g.sun,g.sat).dayOfWeek():v(w.weekday)?e.on(g.mon,g.tue,g.wed,g.thu,g.fri).dayOfWeek():(t=c(w.rank),e.every(t),n=f(e),v(w.start)?(t=c(w.rank),e.startingOn(t),l(n.type)):v(w.between)&&(r=c(w.rank),v(w.and)&&(a=c(w.rank),e.between(r,a))))}function d(e){v(w.first)?e.first():v(w.last)?e.last():e.on(i(w.rank)),f(e)}function f(e){var t=l([w.second,w.minute,w.hour,w.dayOfYear,w.dayOfWeek,w.dayInstance,w.day,w.month,w.year,w.weekOfMonth,w.weekOfYear]);switch(t.type){case w.second:e.second();break;case w.minute:e.minute();break;case w.hour:e.hour();break;case w.dayOfYear:e.dayOfYear();break;case w.dayOfWeek:e.dayOfWeek();break;case w.dayInstance:e.dayOfWeekCount();break;case w.day:e.dayOfMonth();break;case w.weekOfMonth:e.weekOfMonth();break;case w.weekOfYear:e.weekOfYear();break;case w.month:e.month();break;case w.year:e.year();break;default:h=x}return t}function v(e){var t=r(e).type===e;return t&&a(e),t}function l(e){var t=a(e);return t.type?t.text=s(t.text,e):h=x,t}function c(e){return l(e).text}function s(e,t){var n=e;switch(t){case w.time:var r=e.split(/(:|am|pm)/),a="pm"===r[3]&&r[0]<12?parseInt(r[0],10)+12:r[0],u=r[2].trim();n=(1===a.length?"0":"")+a+":"+u;break;case w.rank:n=parseInt(/^\d+/.exec(e)[0],10);break;case w.monthName:case w.dayName:n=g[e.substring(0,3)]}return n}var h,D=t.parse.recur,x=0,m="",w={eof:/^$/,rank:/^((\d+)(st|nd|rd|th)?)\b/,time:/^((([0]?[1-9]|1[0-2]):[0-5]\d(\s)?(am|pm))|(([0]?\d|1\d|2[0-3]):[0-5]\d))\b/,dayName:/^((sun|mon|tue(s)?|wed(nes)?|thu(r(s)?)?|fri|sat(ur)?)(day)?)\b/,monthName:/^(jan(uary)?|feb(ruary)?|ma((r(ch)?)?|y)|apr(il)?|ju(ly|ne)|aug(ust)?|oct(ober)?|(sept|nov|dec)(ember)?)\b/,yearIndex:/^(\d\d\d\d)\b/,every:/^every\b/,after:/^after\b/,before:/^before\b/,second:/^(s|sec(ond)?(s)?)\b/,minute:/^(m|min(ute)?(s)?)\b/,hour:/^(h|hour(s)?)\b/,day:/^(day(s)?( of the month)?)\b/,dayInstance:/^day instance\b/,dayOfWeek:/^day(s)? of the week\b/,dayOfYear:/^day(s)? of the year\b/,weekOfYear:/^week(s)?( of the year)?\b/,weekOfMonth:/^week(s)? of the month\b/,weekday:/^weekday\b/,weekend:/^weekend\b/,month:/^month(s)?\b/,year:/^year(s)?\b/,between:/^between (the)?\b/,start:/^(start(ing)? (at|on( the)?)?)\b/,at:/^(at|@)\b/,and:/^(,|and\b)/,except:/^(except\b)/,also:/(also)\b/,first:/^(first)\b/,last:/^last\b/,in:/^in\b/,of:/^of\b/,onthe:/^on the\b/,on:/^on\b/,through:/(-|^(to|through)\b)/},g={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12,sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7,"1st":1,fir:1,"2nd":2,sec:2,"3rd":3,thi:3,"4th":4,for:4};return function(e){x=0,m=e,h=-1;for(var t=D();x<m.length&&h<0;){switch(l([w.every,w.after,w.before,w.onthe,w.on,w.of,w.in,w.at,w.and,w.except,w.also]).type){case w.every:o(t);break;case w.after:void 0!==r(w.time).type?(t.after(c(w.time)),t.time()):(t.after(c(w.rank)),f(t));break;case w.before:void 0!==r(w.time).type?(t.before(c(w.time)),t.time()):(t.before(c(w.rank)),f(t));break;case w.onthe:d(t);break;case w.on:t.on(i(w.dayName)).dayOfWeek();break;case w.of:t.on(i(w.monthName)).month();break;case w.in:t.on(i(w.yearIndex)).year();break;case w.at:for(t.on(c(w.time)).time();v(w.and);)t.on(c(w.time)).time();break;case w.and:break;case w.also:t.and();break;case w.except:t.except();break;default:h=x}}return{schedules:t.schedules,exceptions:t.exceptions,error:h}}(e.toLowerCase())},t}();